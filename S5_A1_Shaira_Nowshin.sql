DROP DATABASE IF EXISTS S5_A1_Shaira_Nowshin;
CREATE DATABASE IF NOT EXISTS S5_A1_Shaira_Nowshin;
USE S5_A1_Shaira_Nowshin;
SHOW DATABASES;

CREATE TABLE SEASON_NS(
	SEASON_ID_NS INT PRIMARY KEY  NOT NULL UNIQUE,
    SEASON_NAME_NS VARCHAR(10) NOT NULL,
    SEASON_START_DATE_NS DATE NOT NULL,
    SEASON_END_DATE_NS DATE NOT NULL,
    REGISTRATION_START_DATE_NS DATE NOT NULL,
    REGISTRATION_END_DATE_NS DATE NOT NULL
);

CREATE TABLE DIVISION_NS(
	DIVISION_ID_NS INT PRIMARY KEY NOT NULL UNIQUE,
    DIVISION_NAME_NS VARCHAR(3) NOT NULL,
    DIVISION_EMAIL_NS VARCHAR(30) NOT NULL,
    DIVISION_PHONE_NS CHAR(14) NOT NULL,
    AGE_NS INT NOT NULL,
    SEX_NS VARCHAR(5) NOT NULL,
    SEASON_ID_NS INT NOT NULL UNIQUE,
    FOREIGN KEY (SEASON_ID_NS) REFERENCES SEASON_NS (SEASON_ID_NS)
);

CREATE TABLE CLUBS_NS(
    CLUB_ID_NS INTEGER PRIMARY KEY,
    CLUB_NAME_NS VARCHAR(22) NOT NULL,
    CLUB_EMAIL_NS VARCHAR(30) NOT NULL,
    CLUB_PHONE_NS CHAR(14) NOT NULL,
    CLUB_ABBREVIATION_NS CHAR(5) NOT NULL
);

CREATE TABLE MANAGER_NS(
	MANAGER_ID_NS INT PRIMARY KEY NOT NULL UNIQUE,
    FIRST_NAME_NS VARCHAR(25) NOT NULL, 
    MIDDLE_NAME_NS VARCHAR(25) NULL,
    LAST_NAME_NS VARCHAR(25) NOT NULL,
    PHONE_NS CHAR(12) NOT NULL,
    EMAIL_NS VARCHAR(25) NOT NULL
);

CREATE TABLE TEAMS_NS (
    TEAM_ID_NS INTEGER PRIMARY KEY NOT NULL UNIQUE,
    TEAM_NAME_NS VARCHAR(20) NOT NULL,
    TEAM_EMAIL_NS VARCHAR(25) NOT NULL,
    TEAM_PHONE_NS CHAR(14) NOT NULL,
    DIVISION_ID_NS INTEGER NOT NULL,
    CLUB_ID_NS INTEGER NOT NULL,
    MANAGER_ID_NS INTEGER NOT NULL,
    FOREIGN KEY (CLUB_ID_NS) REFERENCES CLUBS_NS(CLUB_ID_NS),
    FOREIGN KEY (MANAGER_ID_NS) REFERENCES MANAGER_NS(MANAGER_ID_NS),
	FOREIGN KEY (DIVISION_ID_NS) REFERENCES DIVISION_NS(DIVISION_ID_NS)
);

CREATE TABLE COACH_NS(
	COACH_ID_NS INTEGER PRIMARY KEY NOT NULL UNIQUE,
    FIRST_NAME_NS VARCHAR(25) NOT NULL,
    MIDDLE_NAME_NS VARCHAR(25) NULL,
    LAST_NAME_NS VARCHAR(25) NOT NULL,
    YEAR_OF_HIRE_NS VARCHAR(10) NOT NULL,
    TEAM_ID_NS INTEGER NOT NULL,
    FOREIGN KEY (TEAM_ID_NS) REFERENCES TEAMS_NS(TEAM_ID_NS)
    );
    
CREATE TABLE ASSIGNMENT_NS(
	DIVISION_ID_NS INT NOT NULL,
    TEAM_ID_NS INTEGER NOT NULL,
    COACH_ID_NS INTEGER NOT NULL,
    FOREIGN KEY (DIVISION_ID_NS) REFERENCES DIVISION_NS(DIVISION_ID_NS),
    FOREIGN KEY (TEAM_ID_NS) REFERENCES TEAMS_NS(TEAM_ID_NS),
    FOREIGN KEY (COACH_ID_NS) REFERENCES COACH_NS(COACH_ID_NS)
);

CREATE TABLE PLAYER_NS(
	PLAYER_ID_NS INTEGER PRIMARY KEY NOT NULL,
    FIRST_NAME_NS VARCHAR(25) NOT NULL,
    MIDDLE_NAME_NS VARCHAR(25) NULL,
    LAST_NAME_NS VARCHAR(25) NOT NULL,
    DATE_OF_BIRTH_NS DATE NOT NULL,
    JERSEY_NUMBER_NS VARCHAR(3) NOT NULL,
    PLAYER_DATE_START_NS VARCHAR(25) NOT NULL,
    TEAM_ID_NS INTEGER NOT NULL,
    FOREIGN KEY (TEAM_ID_NS) REFERENCES TEAMS_NS(TEAM_ID_NS)
    );
    
CREATE TABLE GAME_NS(
	GAME_ID_NS INT PRIMARY KEY NOT NULL UNIQUE,
    DATE_NS DATE NOT NULL,
    TIME_NS TIME NOT NULL,
    SCORE_NS VARCHAR(5),
    WIN_NS VARCHAR(5),
    PLAYED_NS VARCHAR(10),
    COACH_ID_NS INT,
    FOREIGN KEY (COACH_ID_NS) REFERENCES COACH_NS(COACH_ID_NS)
);

DESCRIBE SEASON_NS;
DESCRIBE DIVISION_NS;
DESCRIBE CLUBS_NS;
DESCRIBE MANAGER_NS;
DESCRIBE TEAMS_NS;
DESCRIBE COACH_NS;
DESCRIBE ASSIGNMENT_NS;
DESCRIBE PLAYER_NS;
DESCRIBE GAME_NS;

INSERT INTO SEASON_NS VALUES
    (1, 'FALL2019', '2019-09-01', '2019-12-31', '2019-08-01', '2019-08-31'),
    (2, 'SPRING2019', '2019-03-01', '2019-06-30', '2019-02-01', '2019-02-27'),
    (3, 'WINTER2020', '2019-01-01', '2019-03-31', '2018-12-01', '2018-12-31'),
    (4, 'SUMMER2020', '2020-06-01', '2020-08-31', '2020-03-01', '2020-03-31');
    
INSERT INTO DIVISION_NS VALUES
    (1, 'U13', 'u13boys1@example.com', '(111) 111-1111','13','Girl', 1),
    (2, 'U13', 'u13boys2@example.com', '(222) 222-2222','14','Girl', 2),
    (3, 'U11', 'u11boys@example.com', '(333) 333-3333','13','Boy', 3),
    (4, 'U9', 'u9girls@example.com', '(444) 444-4444','12','Boy', 4);
    
INSERT INTO CLUBS_NS VALUES
    (1, 'Patriots', 'patriots@example.com', '(111) 111-1111', 'PATR'),
    (2, 'Eagles', 'eagles@example.com', '(222) 222-2222', 'EAGL'),
    (3, 'Tigers', 'tigers@example.com', '(333) 333-3333', 'TIGS');
    
INSERT INTO MANAGER_NS VALUES
    (1, 'Brandy', NULL, 'Mellville', '571-234-5678', 'brandymellvile@gmail.com'),
    (2, 'Tom', NULL, 'Holland', '571-567-7890', 'tomholland@gmail.com'),
    (3, 'Zendaya', NULL, 'Coleman', '571-789-0123', 'zendayacoleman@gmail.com'),
    (4, 'Gordan', NULL, 'Ramsay', '571-123-4567', 'gordanramsay@gmail.com');
    
INSERT INTO TEAMS_NS VALUES
    (1, 'Blue', 'blue@example.com', '(111) 111-1111', 1,2,1),
    (2, 'Red', 'red@example.com', '(222) 222-2222', 1,3,1),
    (3, 'White', 'white@example.com', '(111) 111-1111', 2,3,2),
    (4, 'Black', 'black@example.com', '(222) 111-1111',2,1,3);
    
INSERT INTO COACH_NS VALUES
    (1, 'Tim',NULL,'Bradford', 'FALL2019', 1),
    (3, 'John',NULL,'Nolan', 'FALL2019', 2),
    (2, 'Lucy',NULL,'Chen', 'SPRING2019', 3),
    (4, 'Wade',NULL,'Grey', 'SUMMER2019', 4);
    
INSERT INTO PLAYER_NS VALUES
    (1, 'Joel',NULL,'Harris', '2010-10-16', '12', 'FALL2019',1),
    (3, 'Amber',NULL,'Cable', '2010-02-04', '9', 'FALL2019',2),
    (2, 'Nowshin',NULL,'Shaira', '2009-11-23', '3', 'SPRING 2019',3),
    (4, 'Alex',NULL,'Morgan', '2009-07-14', '1', 'SUMMER 2019',4);
    
INSERT INTO GAME_NS VALUES 
	(1, '2019-04-10', '10:00:00', '10', 'WIN', 'PLAYED', 1),
    (2, '2019-04-20', '01:00:00', '9', 'LOSS', 'PLAYED', 2),
    (3, '2019-05-04', '12:00:00', '11', 'WIN', 'PLAYED', 3),
    (4, '2020-05-24', '02:00:00', '8', 'LOSS', 'PLAYED', 4);
    
SELECT * FROM SEASON_NS;
SELECT * FROM DIVISION_NS;
SELECT * FROM CLUBS_NS;
SELECT * FROM MANAGER_NS;
SELECT * FROM TEAMS_NS;
SELECT * FROM COACH_NS;
SELECT * FROM PLAYER_NS;
SELECT * FROM GAME_NS;

SELECT DATE_NS AS 'Game_Date', COUNT(*) AS 'Number_of_Games'
FROM GAME_NS
GROUP BY Game_Date
ORDER BY Game_Date ASC;

SELECT CLUB_NAME_NS, COUNT(DISTINCT TEAM_NAME_NS) AS 'Teams'
FROM TEAMS_NS INNER JOIN CLUBS_NS, SEASON_NS 
WHERE SEASON_NAME_NS = 'SPRING2019'
GROUP BY CLUB_NAME_NS, SEASON_NAME_NS;

SELECT DIVISION_NS.DIVISION_NAME_NS AS Division, COUNT(DISTINCT TEAMS_NS.TEAM_ID_NS) AS Teams_Enrolled
FROM DIVISION_NS
JOIN TEAMS_NS ON DIVISION_NS.DIVISION_ID_NS = TEAMS_NS.DIVISION_ID_NS
JOIN SEASON_NS ON DIVISION_NS.SEASON_ID_NS = SEASON_NS.SEASON_ID_NS
GROUP BY DIVISION_NS.DIVISION_ID_NS, DIVISION_NS.DIVISION_NAME_NS
ORDER BY SEASON_NS.SEASON_START_DATE_NS;

SELECT COACH_NS.COACH_ID_NS AS 'Coach Name', COUNT(WIN_NS) as 'Games Won'
FROM GAME_NS, COACH_NS
WHERE WIN_NS = 'WIN'
GROUP BY COACH_NS.FIRST_NAME_NS AND COACH_NS.LAST_NAME_NS;